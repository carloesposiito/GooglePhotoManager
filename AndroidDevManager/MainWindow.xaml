<Window x:Class="GooglePhotoTransferTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:GooglePhotoTransferTool" xmlns:converters="clr-namespace:GooglePhotoTransferTool.Converters" xmlns:ui="clr-namespace:GooglePhotoTransferTool.UI"
        mc:Ignorable="d"
        d:Height="340"
        BorderThickness="1"
        BorderBrush="DimGray"
        Height="210"
        ResizeMode="NoResize"
        Title="Google Photo Transfer Tool"
        Width="450"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None">

    <Window.Resources>
        <ResourceDictionary>

            <converters:Converter_NullToVisibility x:Key="converter_NullToVisibility"/>

            <Style TargetType="Button">
                <Setter Property="Padding" Value="0,5" />
            </Style>

        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="25"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="25"/>
        </Grid.RowDefinitions>

        <!--Menu row-->
        <Border Background="WhiteSmoke" BorderBrush="DimGray" BorderThickness="0,0,0,0.5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!--Menu-->
                <Menu Background="WhiteSmoke" Grid.Column="0" IsEnabled="{Binding Initialized}" Padding="3,3" VerticalAlignment="Center">

                    <MenuItem Header="Dispositivi" IsCheckable="False">
                        <MenuItem Click="Btn_ScanDevices_Click" Header="Scansiona" IsCheckable="False"/>
                        <MenuItem Click="Btn_ConnectWirelessDevice_Click" Header="Connetti dispositivo Wireless" IsCheckable="False"/>
                        <MenuItem Click="Btn_AuthorizeDevices_Click" Header="Mostra popup autorizzazione" IsCheckable="False"/>
                    </MenuItem>

                    <MenuItem d:Visibility="Visible" Header="Server ADB" IsCheckable="False" Visibility="Collapsed" x:Name="MenuItem_Advanced">
                        <MenuItem Click="Btn_RestartServer_Click" Header="Riavvia" IsCheckable="False"/>
                    </MenuItem>

                </Menu>

                <!--Close button-->
                <Button Click="Btn_Close_Click" Content="X" Cursor="Hand" FontSize="7.5" Grid.Column="1" Height="15" Margin="5,0" Padding="5,0" />

            </Grid>
        </Border>

        <!--Content row-->
        <Border Grid.Row="1" IsEnabled="{Binding DevicesConnected}" Padding="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!--Devices selection row-->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!--Origin device-->
                    <Border BorderThickness="1" BorderBrush="LightGray" Grid.Column="0" Padding="10">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Content="Dispositivo di origine" Grid.Row="0" Margin="0,0,0,7.5" Padding="0" />

                            <ComboBox ItemsSource="{Binding Devices}" DisplayMemberPath="Model" Grid.Row="1" SelectedItem="{Binding OriginDevice, Mode=TwoWay}" SelectionChanged="Cb_Devices_SelectionChanged" />

                            <ui:DeviceUserControl Device="{Binding OriginDevice}" Grid.Row="2" Visibility="{Binding OriginDevice, Converter={StaticResource converter_NullToVisibility}}"/>

                        </Grid>
                    </Border>

                    <!--Destination device-->
                    <Border BorderThickness="1" BorderBrush="LightGray" Grid.Column="2" Padding="10">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Content="Dispositivo di destinazione" Grid.Row="0" Margin="0,0,0,7.5" Padding="0"/>

                            <ComboBox ItemsSource="{Binding Devices}" DisplayMemberPath="Model" Grid.Row="1" SelectedItem="{Binding DestinationDevice, Mode=TwoWay}" SelectionChanged="Cb_Devices_SelectionChanged" />

                            <ui:DeviceUserControl Device="{Binding DestinationDevice}" Grid.Row="2" Visibility="{Binding DestinationDevice, Converter={StaticResource converter_NullToVisibility}}"/>

                        </Grid>
                    </Border>

                </Grid>

                <!--Option and button row-->
                <Grid Grid.Row="1" IsEnabled="{Binding ReadyForTransfer}" Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!--Delete file checkbox-->
                    <CheckBox Content="Cancella immagini dal dispositivo di origine" IsChecked="True" Margin="0,0,0,10" x:Name="Cb_DeleteFromOrigin"/>
                    
                    <!--Transfer button-->    
                    <Button Click="Btn_TransferPhotos_Click" Content="Trasferisci" Grid.Row="1" />
                
                </Grid>

            </Grid>
        </Border>

        <!--Bottom row-->
        <Border Background="WhiteSmoke" BorderBrush="DimGray" BorderThickness="0,0.5,0,0" Grid.Row="2" Padding="10,5">
            <ProgressBar d:Visibility="Visible" Grid.Column="1" IsIndeterminate="True" Visibility="{Binding ProgressBarVisibility}" />
        </Border>

    </Grid>
</Window>
